{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2>{{ post.post_title }}</h2>
    <div class="forum-post">
        <p>{{ post.post_content }}</p>
        <small>Posted by {{ post.author.username }} on {{ post.post_date.strftime('%Y-%m-%d %H:%M') }}</small>
    </div>

    <!-- Toggle button for replies -->
    <button class="toggle-replies" onclick="toggleReplies()">Show Replies</button>

    <!-- Replies section to be expanded or collapsed -->
    <div class="replies" style="display: none;">
        {% for reply in replies %}
        <div class="forum-reply">
            <p>{{ reply.reply_content }}</p>
            <small>by {{ reply.replier.username }} on {{ reply.reply_date.strftime('%Y-%m-%d %H:%M') }}</small>
        </div>
        {% endfor %}
    </div>

    {% if current_user.is_authenticated %}
    <!-- Leave a Reply Form Section -->
    <div class="reply-form-container">
        <h3>Leave a Reply</h3>
        <form method="POST">
            {{ form.hidden_tag() }}
            <div>{{ form.reply_content.label }} {{ form.reply_content(rows=5) }}</div>
            <div>{{ form.submit() }}</div>
        </form>
    </div>
    {% else %}
    <p><a href="{{ url_for('main.login') }}">Log in</a> to leave a reply.</p>
    {% endif %}
</div>
{% endblock %}
